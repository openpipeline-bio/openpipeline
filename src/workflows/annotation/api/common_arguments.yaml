argument_groups:
    - name: Query input
      arguments:
        - name: "--id"
          required: true
          type: string
          description: ID of the sample.
          example: foo
        - name: "--input"
          required: true
          type: file
          description: Input dataset consisting of the (unlabeled) query observations. The dataset is expected to be pre-processed in the same way as --reference.
          example: input.h5mu
          info:
            label: "Query"
            file_format:
              type: h5mu
              mod:
                rna:
                  description: "Modality in AnnData format containing RNA data."
                  required: true
                  slots:
                    X:
                      type: double
                      name: features
                      required: false
                      description: |
                        The expression data to use for the cell type annotation classifier's inference, if `--obsm_embedding` argument is not provided.
                    obsm:
                      - type: "double"
                        name: "features"
                        example: X_pca
                        required: false
                        description: |
                          The embedding to use for the cell type annotation classifier's inference. Could have any name, specified by `obsm_embedding` argument. If not provided, the `.X` slot will be used instead.
                          Make sure that embedding was obtained in the same way as the reference embedding (e.g. by the same model or preprocessing).
        - name: "--modality"
          description: Which modality to process. Should match the modality of the --reference dataset.
          type: string
          default: "rna"
          required: false
        - name: "--obsm_embedding"
          example: "X_pca"
          type: string
          description: Embedding .obsm column to use as input for integration. Should match the embedding .obsm columng of the --reference dataset.

    - name: Reference input
      arguments:
        - name: "--reference"
          required: true
          type: file
          description: Reference dataset consisting of the labeled observations to train the classifier on. The dataset is expected to be pre-processed in the same way as the --input query dataset(s).
          example: reference.h5mu
          info:
            label: "Reference"
            file_format:
              type: h5mu
              mod:
                rna:
                  description: "Modality in AnnData format containing RNA data."
                  required: true
                  slots:
                    X:
                      type: double
                      name: features
                      required: false
                      description: |
                        The expression data to use for the cell type annotation classifier's training, if `--obsm_embedding` argument is not provided.
                    obsm:
                      - type: "double"
                        name: "features"
                        example: X_pca
                        description: |
                          The embedding to use for the cell type annotation classifier's training. 
                          Could have any name, specified by `obsm_embedding` argument.
                          Make sure that embedding was obtained in the same way as the query embedding (e.g. by the same model or preprocessing).
                        required: true
                    obs:
                      - type: "string"
                        name: "targets"
                        multiple: true
                        example: [ ann_level_1, ann_level_2, ann_level_3, ann_level_4, ann_level_5, ann_finest_level ]
                        description: "The target labels to transfer. Provide using the `--obs_reference_targets` argument."
                        required: true
        - name: "--obs_reference_targets"
          type: string
          example: [ ann_level_1, ann_level_2, ann_level_3, ann_level_4, ann_level_5, ann_finest_level ]
          required: true
          multiple: true
          description: The `.obs` key(s) of the target labels to tranfer.
    
    - name: "Outputs"
      arguments:
        - name: "--output"
          type: file
          required: true
          direction: output
          description: The query data in .h5mu format with predicted labels predicted from the classifier trained on the reference.
          example: output.h5mu
          info:
            label: "Output data"
            file_format:
              type: h5mu
              mod:
                rna:
                  description: "Modality in AnnData format containing RNA data."
                  required: true
                  obs:
                    - type: "string"
                      name: "predictions"
                      description: "The predicted labels. Override using the `--output_obs_predictions` argument."
                      required: true
                    - type: "double"
                      name: "probability"
                      description: "The probability of the predicted labels. Override using the `--output_obs_probability` argument."
                      required: false
                  obsm:
                    - type: "double"
                      name: "X_pca"
                      description: 
                        The embedding used for the cell type annotation. Could have any name,
                        specified by `obsm_embedding` argument."
                      required: false
        - name: "--output_obs_predictions"
          type: string
          required: false
          multiple: true
          description: |
            In which `.obs` slots to store the predicted information.
            If provided, must have the same length as `--reference_obs_targets`.
            If empty, will default to the `reference_obs_targets` combined with the `"_pred"` suffix.
        - name: "--output_obs_probability"
          type: string
          required: false
          multiple: true
          description: |
            In which `.obs` slots to store the probability of the predictions.
            If provided, must have the same length as `--reference_obs_targets`.
            If empty, will default to the `reference_obs_targets` combined with the `"_probability"` suffix.
        - name: "--output_compression"
          type: string
          description: |
            The compression format to be used on the output h5mu object.
          choices: ["gzip", "lzf"]
          required: false
          example: "gzip"